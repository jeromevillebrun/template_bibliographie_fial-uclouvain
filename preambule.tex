%Cette page a été concue pour le compilateur xelatex.

%Packages de base
\usepackage{xunicode} %pour l'unicode de XeLaTeX
\usepackage[a4paper]{geometry} %règle les dimensions de la page
\usepackage[french]{babel} %adapte aux spécificités de la langue française
\usepackage[style=verbose-trad3,%style (=numeric par défaut). Mettre sur un style verbose-trad2 ou 3, c'est le style qui ressemble le plus à celui de la FIAL. Il faut mieux mettre verbose-trad3 que verbose-trad2 parce que verbose-trad2 indique pp. X-Y quand il y a plusieurs pages, tandis que trad3 indique p. X-Y.
	sortlocale=auto,%sortlocale (=auto par défaut) fait que les algorithmes alphabétiques de tris unicode s'adaptent à la langue définie par babel (surtout pour ceux qui écrivent en allemand, avec les ß).
	sortcase=false,%sortcase (=true par défaut) Mettre sur false pour trier case insensitively dans la bibliographie
	maxnames=3,%maxnames (=3 par défaut). S'il y a plus de 3 auteurs, biblatex tronque la liste (documentation biblatex, p. 48). Il faudra voir comment il fait pour tronquer la liste ! La norme exige qu'on ajoute "e.a." ex : ROULET Eddy e.a.
	minnames=1,% minnames (=1 par défaut). Définit le nombre d'auteurs à afficher quand il y en a trop (documentation biblatex, p. 48).
	backref=false,%backref (=true par défaut) demande à biblatex d'indiquer à côté de chaque entrée dans la bibliographie les pages auxquelles l'entrée a été citée (documentation biblatex, p. 51).
	backrefstyle=three,%backrefstyle (=three par défaut) indique le formatage des back references (voir documentation biblatex, p. 51).
	isbn=false,%isbn (=true par défaut) pour choisir d'indiquer ou pas l'isbn.
	url=false,%url (=true par défaut) pour choisir d'indiquer ou pas l'url. Même s'il est sur false, les entrées de type @online indiquent quand même l'url (car il est obligatoire pour ce type d'entrées.
	doi=false,%doi (=true par défaut) pour choisir d'indiquer ou pas le doi.
	eprint=false,%eprint (=true par défaut) pour choisir d'indiquer ou pas le eprint.
	citepages=omit,%citepages (=permit par défaut). Mettre sur "omit" pour qu'il empêche d'avoir deux mentions de pages dans la citation : le champ pages et la postnote (documentation biblatex, p. 61).
	%ibidpage=true,%- ibidpage (=false par défaut). Mettre sur true pour indiquer que ibidem sans mention de page signifie "même travail + même page" (documentation biblatex p. 61). Ne fonctionne pas pour verbose-trad3.
	nosortothers=true,%nosortothers (=false par défaut). Mettre sur true pour qu'il ne tienne pas compte des "e.a." (plus de 3 noms d'auteurs) dans le classement.
	strict=false,%strict (=false par défaut) mettre sur false pour éviter des ambiguités dans l'utilisation des ibid.
	giveninits=false,%giveninits (=false par défaut) mettre sur true remplacer tous les prénoms par leurs initiale.
	dashed=false%dashed (=true par défaut) mettre sur false pour ne pas replacer un éditeur qui est le même que l'auteur par un tiret, mais l'imprimer deux fois.
	]{biblatex}
\usepackage{hyperref} %pour des liens hypertexte. chargé après biblatex.
\usepackage{xurl} %pour avoir des url longs bien mis en page
\usepackage{enumitem} %nécessaire pour personnaliser la forme des listes

%Packages "en plus"
\usepackage{lettrine} %pour faire une première lettre géante
\usepackage{oldgerm} %pour une lettrine stylisée
\usepackage[babel]{csquotes} %commande \enquote{} un texte entre «“”»
\usepackage[final]{pdfpages} %pour ajouter page_de_garde_fial.pdf (\includepdf)

%Réglages
\setlist[itemize]{label=\textbullet} %utilise bullet point pour les listes


%----Réglages de bibliographie-----%

\addbibresource{bibdata.bib} %choisit le fichier contenant les références.

\renewcommand{\newunitpunct}{\addcomma\space} %séparateur entre les informations = ","
\renewcommand{\subtitlepunct}{\addperiod\space} %point entre titre et sous-titre
\renewcommand{\revsdnamepunct}{} %pas de "," entre nom et prénom
%Pas besoin de mettre un point après un nom de famille à particule commmençant par une minuscule (c'est dû à un manque de clarté dans le guide de la fial).

% Formatage des noms de personnes > on branche tout sur family-given
\DeclareNameAlias{default}{family-given}% Et partout ailleurs (sauf oubli de la part de MR)
\DeclareNameAlias{labelname}{default}% Lorsqu'on a juste le nom court (citation répétée)
\DeclareNameAlias{sortname}{default}% Dans la biblio finale

%Redéfinir les mots pour le français. On peut trouver les clés dans le fichier /usr/local/texlive/2019/texmf-dist/tex/latex/biblatex/lbx/french.lbx
\DefineBibliographyStrings{french}{%
	in = {dans},%
	andothers = {e\adddot a\adddot}%
}


\DeclareSourcemap{%pour enlever automatiquement les champs non demandés par les normes FIAL.
  \maps[datatype=bibtex]{
    \map{
      \step[fieldset=addendum, null]
      \step[fieldset=note, null]
      \step[fieldset=pagetotal, null]
      \step[fieldset=language, null]
      \step[fieldset=eid, null]
    }
  }
}

\renewcommand*{\intitlepunct}{\space}%Enlève les deux points entre dans et le titre de la revue/ouvrage.
\renewcommand{\mkibid}[1]{\emph{#1}} %Met en italique toutes les chaînes de langue consacrées aux abréviations universitaires de type op. cit. (peut-être pas une si bonne idée : à vérifier. Il est possible que certaines ne doivent justememnt pas être en italiques. Dans ce cas, il faudra tous les redéfinir avec la commande précédente.

\renewbibmacro*{publisher+location+date}{%
  \printlist{location}%
  \iflistundef{publisher}
    {\setunit*{\addcomma\space}}
    {\setunit*{\addcomma\space}}%remplacé collon par comma
  \printlist{publisher}%
  \setunit*{\addcomma\space}%
  \usebibmacro{date}%
  \newunit
}

\renewbibmacro*{series+number}{%
  \iffieldundef{series}
    {}
    {\printtext[parens]{%
      \printfield{series}%
      \setunit*{\addcomma\addspace}%
      \printfield{number}}%
    \newunit}}

\renewbibmacro*{journal+issuetitle}{%
  \usebibmacro{journal}%
  \setunit*{\addcomma\addspace}%
  \iffieldundef{series}
    {}
    {\newunit
     \printfield{series}%
     \setunit{\addspace}}%
  \usebibmacro{volume+number+eid}%
  \setunit{\addspace}%
  \usebibmacro{issue+date}%
  \setunit{\addcolon\space}%
  \usebibmacro{issue}%
  \newunit}

\DeclareBibliographyDriver{book}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author/editor+others/translator+others}%
  \setunit{\printdelim{nametitledelim}}\newblock
  \usebibmacro{maintitle+title}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{byauthor}%
  \newunit\newblock
  \usebibmacro{byeditor+others}%
  \newunit\newblock
  \printfield{edition}%
  \newunit
  \iffieldundef{maintitle}
    {\printfield{volume}%
     \printfield{part}}
    {}%
  \newunit
  \printfield{volumes}%
  \newunit\newblock
  \printfield{note}%
  \newunit\newblock
  \usebibmacro{publisher+location+date}%
  \setunit{\addspace}%
  \usebibmacro{series+number}%
  \newunit\newblock
  \usebibmacro{chapter+pages}%
  \newunit
  \printfield{pagetotal}%
  \newunit\newblock
  \iftoggle{bbx:isbn}
    {\printfield{isbn}}
    {}%
  \newunit\newblock
  \usebibmacro{doi+eprint+url}%
  \newunit\newblock
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \newunit\newblock
  \iftoggle{bbx:related}
    {\usebibmacro{related:init}%
     \usebibmacro{related}}
    {}%
  \usebibmacro{finentry}}

\DeclareBibliographyDriver{article}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author/translator+others}%
  \setunit{\printdelim{nametitledelim}}\newblock
  \usebibmacro{title}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{byauthor}%
  \newunit\newblock
  \usebibmacro{bytranslator+others}%
  \newunit\newblock
  \printfield{version}%
  \newunit\newblock
  \usebibmacro{in:}%
  \usebibmacro{journal+issuetitle}%
  \newunit
  \usebibmacro{byeditor+others}%
  \newunit
  \usebibmacro{note+pages}%
  \newunit\newblock
  \iftoggle{bbx:isbn}
    {\printfield{issn}}
    {}%
  \newunit\newblock
  \usebibmacro{doi+eprint+url}%
  \newunit\newblock
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \newunit\newblock
  \iftoggle{bbx:related}
    {\usebibmacro{related:init}%
     \usebibmacro{related}}
    {}%
  \usebibmacro{finentry}}

