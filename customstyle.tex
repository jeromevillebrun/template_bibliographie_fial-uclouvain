%----Réglages de bibliographie-----%

\addbibresource{bibdata.bib} %choisit le fichier contenant les références.

\renewcommand{\newunitpunct}{\addcomma\space} %séparateur entre les informations = ","
\renewcommand{\subtitlepunct}{\addperiod\space} %point entre titre et sous-titre
\renewcommand{\revsdnamepunct}{} %pas de "," entre nom et prénom
%Pas besoin de mettre un point après un nom de famille à particule commmençant par une minuscule (c'est dû à un manque de clarté dans le guide de la fial).

% Formatage des noms de personnes > on branche tout sur family-given
\DeclareNameAlias{default}{family-given}% Et partout ailleurs (sauf oubli de la part de MR)
\DeclareNameAlias{labelname}{default}% Lorsqu'on a juste le nom court (citation répétée)
\DeclareNameAlias{sortname}{default}% Dans la biblio finale

%Redéfinir les mots pour le français. On peut trouver les clés dans le fichier /usr/local/texlive/2019/texmf-dist/tex/latex/biblatex/lbx/french.lbx
\DefineBibliographyStrings{french}{%
	in = {dans},%
	andothers = {e\adddot a\adddot}%
}


\DeclareSourcemap{%pour enlever automatiquement les champs non demandés par les normes FIAL.
  \maps[datatype=bibtex]{
    \map{
      \step[fieldset=addendum, null]
      \step[fieldset=note, null]
      \step[fieldset=pagetotal, null]
      \step[fieldset=language, null]
      \step[fieldset=eid, null]
    }
  }
}

\renewcommand*{\intitlepunct}{\space}%Enlève les deux points entre dans et le titre de la revue/ouvrage.
\renewcommand{\mkibid}[1]{\emph{#1}} %Met en italique toutes les chaînes de langue consacrées aux abréviations universitaires de type op. cit. (peut-être pas une si bonne idée : à vérifier. Il est possible que certaines ne doivent justememnt pas être en italiques. Dans ce cas, il faudra tous les redéfinir avec la commande précédente.
\DeclareFieldFormat{issuetitle}{\mkbibquote{#1}}

\renewbibmacro*{publisher+location+date}{%
  \printlist{location}%
  \iflistundef{publisher}
    {\setunit*{\addcomma\space}}
    {\setunit*{\addcomma\space}}%remplacé collon par comma
  \printlist{publisher}%
  \setunit*{\addcomma\space}%
  \usebibmacro{date}%
  \newunit
}

\renewbibmacro*{series+number}{%
  \iffieldundef{series}
    {}
    {\printtext[parens]{%
      \printfield{series}%
      \setunit*{\addcomma\addspace}%
      \printfield{number}}%
    \newunit}}

\renewbibmacro*{journal+issuetitle}{%
  \usebibmacro{issue}%ajoute le titre du dossier thématique
  \iffieldundef{issuetitle}{\setunit{\addspace}}{\setunit{\addcomma\space}}%
  \usebibmacro{journal}%
  \setunit*{\addcomma\addspace}%
  \iffieldundef{series}
    {}
    {\newunit
     \printfield{series}%
     \setunit{\addspace}}%
  \usebibmacro{volume+number+eid}%
  \setunit{\addspace}%
  \usebibmacro{issue+date}%
  \newunit}

\renewbibmacro*{issue+date}{%
  \setunit{\addcomma\addspace}%
  \printfield{issue}%
  \setunit*{\addcomma\addspace}%
  \usebibmacro{date}%
  \newunit}

\DeclareBibliographyDriver{book}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author/editor+others/translator+others}%
  \setunit{\printdelim{nametitledelim}}\newblock
  \usebibmacro{maintitle+title}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{byauthor}%
  \newunit\newblock
  \usebibmacro{byeditor+others}%
  \newunit\newblock
  \printfield{edition}%
  \newunit
  \iffieldundef{maintitle}
    {\printfield{volume}%
     \printfield{part}}
    {}%
  \newunit
  \printfield{volumes}%
  \newunit\newblock
  \printfield{note}%
  \newunit\newblock
  \usebibmacro{publisher+location+date}%
  \setunit{\addspace}%
  \usebibmacro{series+number}%
  \newunit\newblock
  \usebibmacro{chapter+pages}%
  \newunit
  \printfield{pagetotal}%
  \newunit\newblock
  \iftoggle{bbx:isbn}
    {\printfield{isbn}}
    {}%
  \newunit\newblock
  \usebibmacro{doi+eprint+url}%
  \newunit\newblock
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \newunit\newblock
  \iftoggle{bbx:related}
    {\usebibmacro{related:init}%
     \usebibmacro{related}}
    {}%
  \usebibmacro{finentry}}

\DeclareBibliographyDriver{article}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author/translator+others}%
  \setunit{\printdelim{nametitledelim}}\newblock
  \usebibmacro{title}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{byauthor}%
  \newunit\newblock
  \usebibmacro{bytranslator+others}%
  \newunit\newblock
  \printfield{version}%
  \newunit\newblock
  \usebibmacro{in:}%
  \usebibmacro{journal+issuetitle}%
  \newunit
  \usebibmacro{byeditor+others}%
  \newunit
  \usebibmacro{note+pages}%
  \newunit\newblock
  \iftoggle{bbx:isbn}
    {\printfield{issn}}
    {}%
  \newunit\newblock
  \usebibmacro{doi+eprint+url}%
  \newunit\newblock
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \newunit\newblock
  \iftoggle{bbx:related}
    {\usebibmacro{related:init}%
     \usebibmacro{related}}
    {}%
  \usebibmacro{finentry}}

